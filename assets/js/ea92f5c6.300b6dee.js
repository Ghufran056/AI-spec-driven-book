"use strict";(globalThis.webpackChunkai_driven_book=globalThis.webpackChunkai_driven_book||[]).push([[2712],{8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}},9678:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"chapter3/3.8-writing-python-ros-nodes","title":"Writing Python ROS Nodes","description":"Learning Objectives","source":"@site/docs/chapter3/3.8-writing-python-ros-nodes.mdx","sourceDirName":"chapter3","slug":"/chapter3/3.8-writing-python-ros-nodes","permalink":"/AI-spec-driven-book/docs/chapter3/3.8-writing-python-ros-nodes","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chapter3/3.8-writing-python-ros-nodes.mdx","tags":[],"version":"current","frontMatter":{"id":"3.8-writing-python-ros-nodes","title":"Writing Python ROS Nodes","sidebar_label":"3.8 - Writing Python ROS Nodes"},"sidebar":"tutorialSidebar","previous":{"title":"3.7 - ROS Tools (RViz, rqt)","permalink":"/AI-spec-driven-book/docs/chapter3/3.7-ros-tools-rviz-rqt"},"next":{"title":"4.1 - Intro to Simulation","permalink":"/AI-spec-driven-book/docs/chapter4/4.1-intro-to-simulation"}}');var r=i(4848),t=i(8453);const o={id:"3.8-writing-python-ros-nodes",title:"Writing Python ROS Nodes",sidebar_label:"3.8 - Writing Python ROS Nodes"},l="Writing Python ROS Nodes",a={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Main Theory",id:"main-theory",level:2},{value:"1. Node Structure",id:"1-node-structure",level:3},{value:"2. Publisher Implementation",id:"2-publisher-implementation",level:3},{value:"3. Subscriber Implementation",id:"3-subscriber-implementation",level:3},{value:"4. Service Server Implementation",id:"4-service-server-implementation",level:3},{value:"5. Parameter Handling",id:"5-parameter-handling",level:3},{value:"6. Node Lifecycle",id:"6-node-lifecycle",level:3},{value:"Examples",id:"examples",level:2},{value:"Example: Simple Publisher Node",id:"example-simple-publisher-node",level:3},{value:"Example: Simple Subscriber Node",id:"example-simple-subscriber-node",level:3},{value:"Example: Parameter Usage",id:"example-parameter-usage",level:3},{value:"Practical Notes",id:"practical-notes",level:2},{value:"Summary",id:"summary",level:2},{value:"Glossary",id:"glossary",level:2},{value:"Quick Quiz",id:"quick-quiz",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"writing-python-ros-nodes",children:"Writing Python ROS Nodes"})}),"\n",(0,r.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(n.p,{children:"By the end of this lesson, you will be able to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create basic ROS nodes in Python using rclpy"}),"\n",(0,r.jsx)(n.li,{children:"Implement publishers and subscribers in Python nodes"}),"\n",(0,r.jsx)(n.li,{children:"Create and use services and actions in Python"}),"\n",(0,r.jsx)(n.li,{children:"Handle parameters in Python ROS nodes"}),"\n",(0,r.jsx)(n.li,{children:"Structure Python packages for ROS 2 nodes"}),"\n",(0,r.jsx)(n.li,{children:"Use ROS 2 client library features in Python"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"Python is one of the most popular languages for robotics development due to its simplicity, extensive libraries, and strong community support. The rclpy package provides the Python client library for ROS 2, enabling developers to create nodes that participate in the ROS 2 communication system. Writing Python nodes follows a straightforward pattern that allows developers to focus on their robot's specific functionality while leveraging the powerful ROS 2 communication infrastructure for message passing, services, and parameter management."}),"\n",(0,r.jsx)(n.p,{children:"The Python client library (rclpy) provides a clean, Pythonic interface to the ROS 2 system, making it accessible to both robotics experts and Python developers who are new to robotics. Python nodes integrate seamlessly with nodes written in other languages like C++, allowing for mixed-language robot systems where each component can be written in the most appropriate language for its specific requirements."}),"\n",(0,r.jsx)(n.h2,{id:"main-theory",children:"Main Theory"}),"\n",(0,r.jsx)(n.h3,{id:"1-node-structure",children:"1. Node Structure"}),"\n",(0,r.jsx)(n.p,{children:"Python ROS nodes are typically structured as classes that inherit from rclpy.node.Node. The node class constructor initializes the node with a name, and the class can contain publishers, subscribers, services, and other ROS components."}),"\n",(0,r.jsx)(n.h3,{id:"2-publisher-implementation",children:"2. Publisher Implementation"}),"\n",(0,r.jsx)(n.p,{children:"Publishers are created using the create_publisher() method, specifying the message type, topic name, and queue size. Messages are sent using the publish() method, with the message object containing the data to be transmitted."}),"\n",(0,r.jsx)(n.h3,{id:"3-subscriber-implementation",children:"3. Subscriber Implementation"}),"\n",(0,r.jsx)(n.p,{children:"Subscribers are created using the create_subscription() method, specifying the message type, topic name, callback function, and queue size. The callback function is executed when messages arrive on the subscribed topic."}),"\n",(0,r.jsx)(n.h3,{id:"4-service-server-implementation",children:"4. Service Server Implementation"}),"\n",(0,r.jsx)(n.p,{children:"Service servers are created using the create_service() method, specifying the service type, service name, and callback function. The callback processes the request and returns a response."}),"\n",(0,r.jsx)(n.h3,{id:"5-parameter-handling",children:"5. Parameter Handling"}),"\n",(0,r.jsx)(n.p,{children:"Parameters can be declared using declare_parameter() and accessed using get_parameter(). This allows nodes to be configured at runtime without recompilation."}),"\n",(0,r.jsx)(n.h3,{id:"6-node-lifecycle",children:"6. Node Lifecycle"}),"\n",(0,r.jsx)(n.p,{children:"Python nodes are initialized using rclpy.init(), added to an executor, and then spun to process callbacks. The node continues running until it's explicitly shut down."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Python Node Structure:\n\n[rclpy.init()] \u2192 [Node Creation] \u2192 [Component Setup] \u2192 [Executor Spin] \u2192 [Shutdown]\n\nBasic Node Skeleton:\nimport rclpy\nfrom rclpy.node import Node\n\nclass MyNode(Node):\n    def __init__(self):\n        super().__init__('node_name')\n        # Setup publishers, subscribers, etc.\n\n    def callback_function(self, msg):\n        # Process received message\n        pass\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(n.h3,{id:"example-simple-publisher-node",children:"Example: Simple Publisher Node"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass TalkerNode(Node):\n    def __init__(self):\n        super().__init__('talker')\n        self.publisher = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.get_clock().now().nanoseconds\n        self.publisher.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    talker = TalkerNode()\n    rclpy.spin(talker)\n    talker.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-simple-subscriber-node",children:"Example: Simple Subscriber Node"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass ListenerNode(Node):\n    def __init__(self):\n        super().__init__('listener')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    listener = ListenerNode()\n    rclpy.spin(listener)\n    listener.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-parameter-usage",children:"Example: Parameter Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def __init__(self):\n    super().__init__('param_node')\n    # Declare parameter with default value\n    self.declare_parameter('frequency', 1.0)\n    freq = self.get_parameter('frequency').value\n    self.timer = self.create_timer(1.0/freq, self.timer_callback)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"practical-notes",children:"Practical Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Always call super().",(0,r.jsx)(n.strong,{children:"init"}),"() with a unique node name in your custom node's ",(0,r.jsx)(n.strong,{children:"init"})," method"]}),"\n",(0,r.jsx)(n.li,{children:"Use self.get_logger().info() for logging messages instead of print()"}),"\n",(0,r.jsx)(n.li,{children:"Remember to destroy the node and shutdown rclpy in your main function"}),"\n",(0,r.jsx)(n.li,{children:"Set appropriate queue sizes for publishers and subscribers based on message frequency"}),"\n",(0,r.jsx)(n.li,{children:"Use try-except blocks around rclpy.init() and spin() for graceful error handling"}),"\n",(0,r.jsx)(n.li,{children:"Declare parameters with default values to make nodes more configurable"}),"\n",(0,r.jsx)(n.li,{children:"Use appropriate data types from standard message packages when possible"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Writing Python ROS nodes is straightforward with the rclpy client library, which provides clean interfaces for all ROS 2 communication patterns. By structuring nodes as classes inheriting from rclpy.node.Node, developers can easily implement publishers, subscribers, services, and parameter handling. The Python ecosystem combined with ROS 2's communication infrastructure enables rapid development and prototyping of robot systems, while the seamless integration with other language nodes allows for complex, multi-component robot applications."}),"\n",(0,r.jsx)(n.h2,{id:"glossary",children:"Glossary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"rclpy"}),": Python client library for ROS 2 that provides Python bindings to the ROS 2 system"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node"}),": Basic execution unit in ROS that performs computation and communicates with other nodes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Publisher"}),": Object that sends messages to a topic in a ROS node"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscriber"}),": Object that receives messages from a topic in a ROS node"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Callback"}),": Function executed when a message is received by a subscriber or service request is received"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Message"}),": Data structure exchanged between nodes through topics"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topic"}),": Named bus over which nodes exchange messages using publish-subscribe pattern"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service"}),": Synchronous request-response communication pattern between nodes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameter"}),": Configurable value that can be set at runtime to change node behavior"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Executor"}),": Component that manages the execution of callbacks in ROS nodes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Clock"}),": ROS component that provides time information for synchronization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Logger"}),": Component that provides logging functionality for debugging and monitoring"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Queue Size"}),": Maximum number of messages to buffer for publishers and subscribers"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"quick-quiz",children:"Quick Quiz"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"What is the main Python client library for ROS 2?\nA) rospy\nB) rclpy\nC) roslib\nD) pyros"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["How do you properly initialize a ROS 2 node in Python?\nA) node.init('node_name')\nB) rclpy.start('node_name')\nC) super().",(0,r.jsx)(n.strong,{children:"init"}),"('node_name')\nD) rclpy.create_node('node_name')"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Which method is used to create a publisher in a Python ROS node?\nA) create_pub()\nB) make_publisher()\nC) create_publisher()\nD) add_publisher()"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"What is the purpose of the rclpy.spin() function?\nA) To compile the code\nB) To process callbacks and keep the node running\nC) To stop the node\nD) To create a new thread"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"How should you handle logging in a Python ROS node?\nA) Use print() statements\nB) Use self.get_logger().info()\nC) Write to a file directly\nD) Use sys.stdout.write()"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Answers:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"B) rclpy"}),"\n",(0,r.jsxs)(n.li,{children:["C) super().",(0,r.jsx)(n.strong,{children:"init"}),"('node_name')"]}),"\n",(0,r.jsx)(n.li,{children:"C) create_publisher()"}),"\n",(0,r.jsx)(n.li,{children:"B) To process callbacks and keep the node running"}),"\n",(0,r.jsx)(n.li,{children:"B) Use self.get_logger().info()"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);